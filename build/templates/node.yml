parameters:
  skipInstall: false

steps:
  - task: NodeTool@0
    displayName: Use Node 18.x
    inputs:
      versionSpec: 18.x

  - task: npmAuthenticate@0
    inputs:
      workingFile: '$(Build.SourcesDirectory)/.npmrc'

  - task: npmAuthenticate@0
    inputs:
      workingFile: '$(Build.SourcesDirectory)/packages/pyright/.npmrc'

  - task: npmAuthenticate@0
    inputs:
      workingFile: '$(Build.SourcesDirectory)/packages/pyright-internal/.npmrc'

  - task: npmAuthenticate@0
    inputs:
      workingFile: '$(Build.SourcesDirectory)/packages/vscode-pyright/.npmrc'

  - ${{ if eq(parameters.skipInstall, false)}}:
      task: CmdLine@2
      displayName: npm install
      inputs:
        script: npm run install:all
